<div class="analytics-seo">
    <div class="analytics-header">
        <h1 class="page-title">SEO Performance</h1>
        <p class="page-subtitle">Monitor search engine optimization and organic traffic performance</p>
    </div>

    <!-- SEO Overview -->
    <div class="seo-overview">
        <div class="overview-card">
            <div class="card-icon">
                <i class="ph-bold ph-trend-up"></i>
            </div>
            <div class="card-content">
                <div class="card-value" id="organicTraffic">0</div>
                <div class="card-label">Organic Traffic</div>
                <div class="card-trend" id="organicTrend">
                    <i class="ph-bold ph-trend-up"></i>
                    <span>+24.5%</span>
                </div>
            </div>
        </div>

        <div class="overview-card">
            <div class="card-icon">
                <i class="ph-bold ph-target"></i>
            </div>
            <div class="card-content">
                <div class="card-value" id="keywordRankings">0</div>
                <div class="card-label">Keywords Ranking</div>
                <div class="card-trend" id="rankingTrend">
                    <i class="ph-bold ph-trend-up"></i>
                    <span>+18.2%</span>
                </div>
            </div>
        </div>

        <div class="overview-card">
            <div class="card-icon">
                <i class="ph-bold ph-link"></i>
            </div>
            <div class="card-content">
                <div class="card-value" id="backlinks">0</div>
                <div class="card-label">Backlinks</div>
                <div class="card-trend" id="backlinksTrend">
                    <i class="ph-bold ph-trend-up"></i>
                    <span>+12.8%</span>
                </div>
            </div>
        </div>

        <div class="overview-card">
            <div class="card-icon">
                <i class="ph-bold ph-crown"></i>
            </div>
            <div class="card-content">
                <div class="card-value" id="domainAuthority">0</div>
                <div class="card-label">Domain Authority</div>
                <div class="card-trend" id="authorityTrend">
                    <i class="ph-bold ph-trend-up"></i>
                    <span>+5.3%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- SEO Trends Chart -->
    <div class="seo-trends-section">
        <div class="section-header">
            <h2>SEO Performance Trends</h2>
            <div class="trend-filters">
                <button class="trend-filter-btn active" data-period="7d">7 Days</button>
                <button class="trend-filter-btn" data-period="30d">30 Days</button>
                <button class="trend-filter-btn" data-period="90d">90 Days</button>
                <button class="trend-filter-btn" data-period="1y">1 Year</button>
            </div>
        </div>
        <div class="seo-chart">
            <canvas id="seoTrendsChart"></canvas>
        </div>
    </div>

    <!-- SEO Breakdown -->
    <div class="seo-breakdown">
        <div class="breakdown-card">
            <div class="card-header">
                <h3>Top Keywords</h3>
            </div>
            <div class="keywords-list" id="topKeywords">
                <!-- Top keywords will be populated here -->
            </div>
        </div>

        <div class="breakdown-card">
            <div class="card-header">
                <h3>Search Engine Distribution</h3>
            </div>
            <div class="search-engines">
                <div class="engine-item">
                    <div class="engine-info">
                        <div class="engine-name">Google</div>
                        <div class="engine-percentage" id="googlePercentage">0%</div>
                    </div>
                    <div class="engine-bar">
                        <div class="engine-fill google" id="googleBar"></div>
                    </div>
                    <div class="engine-traffic" id="googleTraffic">0</div>
                </div>
                <div class="engine-item">
                    <div class="engine-info">
                        <div class="engine-name">Bing</div>
                        <div class="engine-percentage" id="bingPercentage">0%</div>
                    </div>
                    <div class="engine-bar">
                        <div class="engine-fill bing" id="bingBar"></div>
                    </div>
                    <div class="engine-traffic" id="bingTraffic">0</div>
                </div>
                <div class="engine-item">
                    <div class="engine-info">
                        <div class="engine-name">Yahoo</div>
                        <div class="engine-percentage" id="yahooPercentage">0%</div>
                    </div>
                    <div class="engine-bar">
                        <div class="engine-fill yahoo" id="yahooBar"></div>
                    </div>
                    <div class="engine-traffic" id="yahooTraffic">0</div>
                </div>
                <div class="engine-item">
                    <div class="engine-info">
                        <div class="engine-name">Others</div>
                        <div class="engine-percentage" id="othersPercentage">0%</div>
                    </div>
                    <div class="engine-bar">
                        <div class="engine-fill others" id="othersBar"></div>
                    </div>
                    <div class="engine-traffic" id="othersTraffic">0</div>
                </div>
            </div>
        </div>
    </div>

    <!-- SEO Health Metrics -->
    <div class="seo-health">
        <div class="section-header">
            <h2>SEO Health Metrics</h2>
        </div>
        <div class="health-metrics">
            <div class="health-card">
                <div class="health-header">
                    <h3>Page Speed Score</h3>
                    <div class="health-score" id="speedScore">0</div>
                </div>
                <div class="health-bar">
                    <div class="health-fill speed" id="speedBar"></div>
                </div>
                <div class="health-status" id="speedStatus">Good</div>
            </div>

            <div class="health-card">
                <div class="health-header">
                    <h3>Mobile Friendliness</h3>
                    <div class="health-score" id="mobileScore">0</div>
                </div>
                <div class="health-bar">
                    <div class="health-fill mobile" id="mobileBar"></div>
                </div>
                <div class="health-status" id="mobileStatus">Good</div>
            </div>

            <div class="health-card">
                <div class="health-header">
                    <h3>Core Web Vitals</h3>
                    <div class="health-score" id="coreVitalsScore">0</div>
                </div>
                <div class="health-bar">
                    <div class="health-fill vitals" id="coreVitalsBar"></div>
                </div>
                <div class="health-status" id="coreVitalsStatus">Good</div>
            </div>

            <div class="health-card">
                <div class="health-header">
                    <h3>HTTPS Security</h3>
                    <div class="health-score" id="securityScore">0</div>
                </div>
                <div class="health-bar">
                    <div class="health-fill security" id="securityBar"></div>
                </div>
                <div class="health-status" id="securityStatus">Secure</div>
            </div>
        </div>
    </div>

    <!-- SEO Opportunities -->
    <div class="seo-opportunities">
        <div class="section-header">
            <h2>SEO Opportunities & Recommendations</h2>
        </div>
        <div class="opportunities-grid">
            <div class="opportunity-card">
                <div class="opportunity-icon">
                    <i class="ph-bold ph-magnifying-glass"></i>
                </div>
                <div class="opportunity-content">
                    <h4>Keyword Opportunities</h4>
                    <p>Discover high-volume, low-competition keywords in your niche</p>
                    <div class="opportunity-tags" id="keywordOpportunities">
                        <!-- Keyword opportunities will be populated here -->
                    </div>
                </div>
            </div>

            <div class="opportunity-card">
                <div class="opportunity-icon">
                    <i class="ph-bold ph-link"></i>
                </div>
                <div class="opportunity-content">
                    <h4>Link Building</h4>
                    <p>Identify opportunities for high-quality backlinks</p>
                    <div class="opportunity-stats">
                        <div class="stat">Potential links: <span id="potentialLinks">0</span></div>
                        <div class="stat">Target domains: <span id="targetDomains">0</span></div>
                    </div>
                </div>
            </div>

            <div class="opportunity-card">
                <div class="opportunity-icon">
                    <i class="ph-bold ph-file-text"></i>
                </div>
                <div class="opportunity-content">
                    <h4>Content Gaps</h4>
                    <p>Topics your competitors rank for that you're missing</p>
                    <div class="opportunity-list" id="contentGaps">
                        <!-- Content gaps will be populated here -->
                    </div>
                </div>
            </div>

            <div class="opportunity-card">
                <div class="opportunity-icon">
                    <i class="ph-bold ph-wrench"></i>
                </div>
                <div class="opportunity-content">
                    <h4>Technical Fixes</h4>
                    <p>SEO issues that need immediate attention</p>
                    <div class="opportunity-issues" id="technicalIssues">
                        <!-- Technical issues will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SEO Insights -->
    <div class="seo-insights">
        <div class="section-header">
            <h2>SEO Insights & Trends</h2>
        </div>
        <div class="insights-content">
            <div class="insight-card">
                <h4>Search Intent Analysis</h4>
                <p>Your content matches <span id="intentMatch">0%</span> of search intents for your target keywords</p>
                <div class="insight-chart">
                    <canvas id="intentChart"></canvas>
                </div>
            </div>

            <div class="insight-card">
                <h4>Competitor Analysis</h4>
                <p>You rank above <span id="competitorRank">0%</span> of your competitors for target keywords</p>
                <div class="competitor-list" id="competitorComparison">
                    <!-- Competitor comparison will be populated here -->
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.analytics-seo {
    padding: 2rem;
    max-width: 1400px;
    margin: 0 auto;
}

.analytics-header {
    margin-bottom: 3rem;
    text-align: center;
}

.page-title {
    font: normal 700 2.38rem/1.2 var(--_font-accent);
    color: var(--t-accent);
    background: var(--t-accent);
    background: -webkit-linear-gradient(15deg, var(--t-accent) 0%, var(--t-secondary) 80%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 0.5rem;
}

.page-subtitle {
    font: normal 400 1.26rem/1.4 var(--_font-default);
    color: var(--t-medium);
}

/* SEO Overview */
.seo-overview {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
}

.overview-card {
    background: var(--base);
    border: 1px solid var(--stroke-elements);
    border-radius: var(--_radius-l);
    padding: 2rem;
    display: flex;
    align-items: center;
    gap: 1.5rem;
    transition: all var(--_animspeed-medium) var(--_animbezier);
}

.overview-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.card-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: var(--accent);
    background: -webkit-linear-gradient(315deg, var(--accent) 0%, var(--secondary) 100%);
    background: linear-gradient(135deg, var(--accent) 0%, var(--secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--t-opp-bright);
    font-size: 2rem;
}

.card-content {
    flex: 1;
}

.card-value {
    font: normal 700 1.96rem/1.2 var(--_font-accent);
    color: var(--t-bright);
    margin-bottom: 0.5rem;
}

.card-label {
    font: normal 500 0.98rem/1.2 var(--_font-default);
    color: var(--t-medium);
    margin-bottom: 0.5rem;
}

.card-trend {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font: normal 500 0.84rem/1.2 var(--_font-default);
    color: var(--success, #10b981);
}

.card-trend.negative {
    color: var(--error, #ef4444);
}

/* SEO Trends Section */
.seo-trends-section {
    background: var(--base);
    border: 1px solid var(--stroke-elements);
    border-radius: var(--_radius-l);
    padding: 2rem;
    margin-bottom: 3rem;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.section-header h2 {
    font: normal 600 1.68rem/1.2 var(--_font-accent);
    color: var(--t-bright);
    margin: 0;
}

.trend-filters {
    display: flex;
    gap: 0.5rem;
}

.trend-filter-btn {
    background: none;
    border: 1px solid var(--stroke-elements);
    color: var(--t-medium);
    padding: 0.5rem 1rem;
    border-radius: var(--_radius-s);
    cursor: pointer;
    transition: all var(--_animspeed-medium) var(--_animbezier);
    font: normal 500 0.98rem/1.2 var(--_font-default);
}

.trend-filter-btn.active {
    background: var(--accent);
    color: var(--t-opp-bright);
    border-color: var(--accent);
}

.seo-chart {
    height: 400px;
    position: relative;
}

/* SEO Breakdown */
.seo-breakdown {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    margin-bottom: 3rem;
}

.breakdown-card {
    background: var(--base);
    border: 1px solid var(--stroke-elements);
    border-radius: var(--_radius-l);
    padding: 2rem;
}

.card-header h3 {
    font: normal 600 1.4rem/1.2 var(--_font-accent);
    color: var(--t-bright);
    margin: 0 0 2rem 0;
}

/* Keywords List */
.keywords-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.keyword-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem;
    border-radius: var(--_radius-m);
    transition: all var(--_animspeed-medium) var(--_animbezier);
    border: 1px solid var(--stroke-elements);
}

.keyword-item:hover {
    transform: translateX(4px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.keyword-text {
    font: normal 500 0.98rem/1.2 var(--_font-default);
    color: var(--t-bright);
}

.keyword-position {
    font: normal 600 0.98rem/1.2 var(--_font-default);
    color: var(--accent);
}

.keyword-change {
    font: normal 500 0.84rem/1.2 var(--_font-default);
    color: var(--success, #10b981);
}

.keyword-change.negative {
    color: var(--error, #ef4444);
}

/* Search Engines */
.search-engines {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.engine-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.engine-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.engine-name {
    font: normal 500 0.98rem/1.2 var(--_font-default);
    color: var(--t-bright);
}

.engine-percentage {
    font: normal 600 0.98rem/1.2 var(--_font-default);
    color: var(--accent);
}

.engine-bar {
    height: 8px;
    background: var(--stroke-elements);
    border-radius: 4px;
    overflow: hidden;
}

.engine-fill {
    height: 100%;
    border-radius: 4px;
    transition: width var(--_animspeed-slow) var(--_animbezier);
}

.engine-fill.google { background: var(--accent); }
.engine-fill.bing { background: var(--secondary); }
.engine-fill.yahoo { background: var(--success, #10b981); }
.engine-fill.others { background: var(--warning, #f59e0b); }

.engine-traffic {
    font: normal 500 0.91rem/1.2 var(--_font-default);
    color: var(--t-medium);
    text-align: right;
}

/* SEO Health */
.seo-health {
    background: var(--base);
    border: 1px solid var(--stroke-elements);
    border-radius: var(--_radius-l);
    padding: 2rem;
    margin-bottom: 3rem;
}

.health-metrics {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
}

.health-card {
    background: var(--stroke-elements);
    border-radius: var(--_radius-m);
    padding: 2rem;
}

.health-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.health-header h3 {
    font: normal 600 1.12rem/1.2 var(--_font-default);
    color: var(--t-bright);
    margin: 0;
}

.health-score {
    font: normal 700 1.68rem/1.2 var(--_font-accent);
    color: var(--accent);
}

.health-bar {
    height: 8px;
    background: var(--stroke-elements);
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 1rem;
}

.health-fill {
    height: 100%;
    border-radius: 4px;
    transition: width var(--_animspeed-slow) var(--_animbezier);
}

.health-fill.speed { background: var(--accent); }
.health-fill.mobile { background: var(--secondary); }
.health-fill.vitals { background: var(--success, #10b981); }
.health-fill.security { background: var(--warning, #f59e0b); }

.health-status {
    font: normal 500 0.98rem/1.2 var(--_font-default);
    color: var(--success, #10b981);
}

/* SEO Opportunities */
.seo-opportunities {
    background: var(--base);
    border: 1px solid var(--stroke-elements);
    border-radius: var(--_radius-l);
    padding: 2rem;
    margin-bottom: 3rem;
}

.opportunities-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
}

.opportunity-card {
    background: var(--stroke-elements);
    border-radius: var(--_radius-m);
    padding: 2rem;
    display: flex;
    gap: 1.5rem;
    transition: all var(--_animspeed-medium) var(--_animbezier);
}

.opportunity-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.opportunity-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--accent);
    background: -webkit-linear-gradient(315deg, var(--accent) 0%, var(--secondary) 100%);
    background: linear-gradient(135deg, var(--accent) 0%, var(--secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--t-opp-bright);
    font-size: 1.5rem;
    flex-shrink: 0;
}

.opportunity-content {
    flex: 1;
}

.opportunity-content h4 {
    font: normal 600 1.12rem/1.2 var(--_font-default);
    color: var(--t-bright);
    margin: 0 0 0.5rem 0;
}

.opportunity-content p {
    font: normal 400 0.98rem/1.2 var(--_font-default);
    color: var(--t-medium);
    margin: 0 0 1rem 0;
}

.opportunity-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.opportunity-tag {
    background: var(--accent);
    color: var(--t-opp-bright);
    padding: 0.25rem 0.75rem;
    border-radius: var(--_radius-s);
    font: normal 500 0.84rem/1.2 var(--_font-default);
}

.opportunity-stats {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.opportunity-stats .stat {
    font: normal 500 0.91rem/1.2 var(--_font-default);
    color: var(--t-bright);
}

.opportunity-list, .opportunity-issues {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.opportunity-item {
    font: normal 400 0.91rem/1.2 var(--_font-default);
    color: var(--t-medium);
    padding: 0.5rem;
    background: var(--base);
    border-radius: var(--_radius-s);
}

/* SEO Insights */
.seo-insights {
    background: var(--base);
    border: 1px solid var(--stroke-elements);
    border-radius: var(--_radius-l);
    padding: 2rem;
}

.insights-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
}

.insight-card h4 {
    font: normal 600 1.26rem/1.2 var(--_font-default);
    color: var(--t-bright);
    margin: 0 0 1rem 0;
}

.insight-card p {
    font: normal 400 0.98rem/1.2 var(--_font-default);
    color: var(--t-medium);
    margin: 0 0 2rem 0;
}

.insight-chart {
    height: 200px;
    position: relative;
}

.competitor-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.competitor-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem;
    background: var(--stroke-elements);
    border-radius: var(--_radius-m);
}

.competitor-name {
    font: normal 500 0.98rem/1.2 var(--_font-default);
    color: var(--t-bright);
}

.competitor-rank {
    font: normal 600 0.98rem/1.2 var(--_font-default);
    color: var(--accent);
}

/* Responsive Design */
@media (max-width: 1024px) {
    .seo-breakdown {
        grid-template-columns: 1fr;
    }

    .insights-content {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .analytics-seo {
        padding: 1rem;
    }

    .seo-overview {
        grid-template-columns: 1fr;
    }

    .health-metrics {
        grid-template-columns: 1fr;
    }

    .opportunities-grid {
        grid-template-columns: 1fr;
    }

    .section-header {
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
    }

    .trend-filters {
        width: 100%;
        justify-content: center;
    }

    .opportunity-card {
        flex-direction: column;
        text-align: center;
    }
}
</style>

<script>
// SEO Analytics JavaScript
document.addEventListener('DOMContentLoaded', function() {
    initSEOAnalytics();
});

function initSEOAnalytics() {
    loadSEOData();
    initTrendFilters();
}

function loadSEOData() {
    fetch('/api/analytics/seo')
        .then(response => response.json())
        .then(data => {
            updateSEOOverview(data.overview);
            updateSEOChart(data.trends);
            updateSEOKeywords(data.keywords);
            updateSearchEngines(data.engines);
            updateSEOHealth(data.health);
            updateSEOOpportunities(data.opportunities);
            updateSEOInsights(data.insights);
        })
        .catch(error => {
            console.error('Error loading SEO data:', error);
            showFallbackSEOData();
        });
}

function updateSEOOverview(overview) {
    document.getElementById('organicTraffic').textContent = overview.organicTraffic.toLocaleString();
    document.getElementById('keywordRankings').textContent = overview.keywordRankings.toLocaleString();
    document.getElementById('backlinks').textContent = overview.backlinks.toLocaleString();
    document.getElementById('domainAuthority').textContent = overview.domainAuthority;

    updateTrend('organicTrend', overview.organicChange);
    updateTrend('rankingTrend', overview.rankingChange);
    updateTrend('backlinksTrend', overview.backlinksChange);
    updateTrend('authorityTrend', overview.authorityChange);
}

function updateTrend(elementId, change) {
    const element = document.getElementById(elementId);
    const span = element.querySelector('span');
    span.textContent = (change >= 0 ? '+' : '') + Math.abs(change).toFixed(1) + '%';
}

function updateSEOChart(trendsData) {
    const ctx = document.getElementById('seoTrendsChart').getContext('2d');

    // Destroy existing chart if it exists
    if (window.seoChart) {
        window.seoChart.destroy();
    }

    window.seoChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: trendsData.labels,
            datasets: [{
                label: 'Organic Traffic',
                data: trendsData.organicTraffic,
                borderColor: 'var(--accent)',
                backgroundColor: 'rgba(124, 58, 237, 0.1)',
                tension: 0.4,
                fill: true
            }, {
                label: 'Keyword Rankings',
                data: trendsData.keywordRankings,
                borderColor: 'var(--secondary)',
                backgroundColor: 'rgba(236, 72, 153, 0.1)',
                tension: 0.4,
                fill: true
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

function updateSEOKeywords(keywords) {
    const container = document.getElementById('topKeywords');
    container.innerHTML = keywords.map(keyword => `
        <div class="keyword-item">
            <div class="keyword-text">${keyword.text}</div>
            <div class="keyword-position">#${keyword.position}</div>
            <div class="keyword-change ${keyword.change < 0 ? 'negative' : ''}">
                ${keyword.change > 0 ? '+' : ''}${keyword.change}
            </div>
        </div>
    `).join('');
}

function updateSearchEngines(engines) {
    const total = engines.google + engines.bing + engines.yahoo + engines.others;

    updateEngineBar('google', engines.google, total);
    updateEngineBar('bing', engines.bing, total);
    updateEngineBar('yahoo', engines.yahoo, total);
    updateEngineBar('others', engines.others, total);
}

function updateEngineBar(engine, traffic, total) {
    const percentage = total > 0 ? (traffic / total * 100) : 0;
    document.getElementById(`${engine}Percentage`).textContent = Math.round(percentage) + '%';
    document.getElementById(`${engine}Bar`).style.width = percentage + '%';
    document.getElementById(`${engine}Traffic`).textContent = traffic.toLocaleString();
}

function updateSEOHealth(health) {
    updateHealthMetric('speed', health.speed);
    updateHealthMetric('mobile', health.mobile);
    updateHealthMetric('coreVitals', health.coreVitals);
    updateHealthMetric('security', health.security);
}

function updateHealthMetric(type, data) {
    document.getElementById(`${type}Score`).textContent = data.score;
    document.getElementById(`${type}Bar`).style.width = data.percentage + '%';
    document.getElementById(`${type}Status`).textContent = data.status;
}

function updateSEOOpportunities(opportunities) {
    updateTags('keywordOpportunities', opportunities.keywords, 'opportunity-tag');
    document.getElementById('potentialLinks').textContent = opportunities.links.potential;
    document.getElementById('targetDomains').textContent = opportunities.links.domains;
    updateList('contentGaps', opportunities.contentGaps, 'opportunity-item');
    updateList('technicalIssues', opportunities.technicalIssues, 'opportunity-item');
}

function updateTags(containerId, tags, className) {
    const container = document.getElementById(containerId);
    container.innerHTML = tags.map(tag => `<span class="${className}">${tag}</span>`).join('');
}

function updateList(containerId, items, className) {
    const container = document.getElementById(containerId);
    container.innerHTML = items.map(item => `<div class="${className}">${item}</div>`).join('');
}

function updateSEOInsights(insights) {
    document.getElementById('intentMatch').textContent = insights.intentMatch + '%';
    document.getElementById('competitorRank').textContent = insights.competitorRank + '%';

    // Update intent chart
    const intentCtx = document.getElementById('intentChart').getContext('2d');
    new Chart(intentCtx, {
        type: 'doughnut',
        data: {
            labels: insights.intentData.labels,
            datasets: [{
                data: insights.intentData.values,
                backgroundColor: [
                    'var(--accent)',
                    'var(--secondary)',
                    'var(--success, #10b981)',
                    'var(--warning, #f59e0b)'
                ]
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                }
            }
        }
    });

    // Update competitor comparison
    const competitorContainer = document.getElementById('competitorComparison');
    competitorContainer.innerHTML = insights.competitors.map(competitor => `
        <div class="competitor-item">
            <div class="competitor-name">${competitor.name}</div>
            <div class="competitor-rank">#${competitor.rank}</div>
        </div>
    `).join('');
}

function initTrendFilters() {
    document.querySelectorAll('.trend-filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.trend-filter-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            loadSEOTrends(this.dataset.period);
        });
    });
}

function loadSEOTrends(period) {
    fetch(`/api/analytics/seo/trends?period=${period}`)
        .then(response => response.json())
        .then(data => updateSEOChart(data))
        .catch(error => console.error('Error loading SEO trends:', error));
}

function showFallbackSEOData() {
    // Show sample data when API is not available
    updateSEOOverview({
        organicTraffic: 15432,
        keywordRankings: 89,
        backlinks: 1247,
        domainAuthority: 45,
        organicChange: 24.5,
        rankingChange: 18.2,
        backlinksChange: 12.8,
        authorityChange: 5.3
    });
}
</script>