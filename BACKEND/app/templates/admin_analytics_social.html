<div class="analytics-social">
    <div class="analytics-header">
        <h1 class="page-title">Social Media Analytics</h1>
        <p class="page-subtitle">Track social media performance and engagement</p>
    </div>

    <!-- Social Overview -->
    <div class="social-overview">
        <div class="overview-card">
            <div class="card-icon">
                <i class="ph-bold ph-users"></i>
            </div>
            <div class="card-content">
                <div class="card-value" id="totalFollowers">0</div>
                <div class="card-label">Total Followers</div>
                <div class="card-trend" id="followersTrend">
                    <i class="ph-bold ph-trend-up"></i>
                    <span>+15.2%</span>
                </div>
            </div>
        </div>

        <div class="overview-card">
            <div class="card-icon">
                <i class="ph-bold ph-heart"></i>
            </div>
            <div class="card-content">
                <div class="card-value" id="totalEngagement">0</div>
                <div class="card-label">Total Engagement</div>
                <div class="card-trend" id="engagementTrend">
                    <i class="ph-bold ph-trend-up"></i>
                    <span>+22.4%</span>
                </div>
            </div>
        </div>

        <div class="overview-card">
            <div class="card-icon">
                <i class="ph-bold ph-eye"></i>
            </div>
            <div class="card-content">
                <div class="card-value" id="totalImpressions">0</div>
                <div class="card-label">Total Impressions</div>
                <div class="card-trend" id="impressionsTrend">
                    <i class="ph-bold ph-trend-up"></i>
                    <span>+18.7%</span>
                </div>
            </div>
        </div>

        <div class="overview-card">
            <div class="card-icon">
                <i class="ph-bold ph-share"></i>
            </div>
            <div class="card-content">
                <div class="card-value" id="totalShares">0</div>
                <div class="card-label">Total Shares</div>
                <div class="card-trend" id="sharesTrend">
                    <i class="ph-bold ph-trend-up"></i>
                    <span>+12.1%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Social Performance Chart -->
    <div class="social-performance-section">
        <div class="section-header">
            <h2>Social Media Performance</h2>
            <div class="platform-filters">
                <button class="platform-filter-btn active" data-platform="all">All</button>
                <button class="platform-filter-btn" data-platform="twitter">Twitter</button>
                <button class="platform-filter-btn" data-platform="facebook">Facebook</button>
                <button class="platform-filter-btn" data-platform="instagram">Instagram</button>
            </div>
        </div>
        <div class="social-chart">
            <canvas id="socialPerformanceChart"></canvas>
        </div>
    </div>

    <!-- Platform Breakdown & Top Posts -->
    <div class="platform-breakdown">
        <div class="breakdown-card">
            <div class="card-header">
                <h3>Platform Performance</h3>
            </div>
            <div class="platforms-grid" id="platformsGrid">
                <!-- Platform cards will be populated here -->
            </div>
        </div>

        <div class="breakdown-card">
            <div class="card-header">
                <h3>Top Posts</h3>
            </div>
            <div class="top-posts-list" id="topPostsList">
                <!-- Top posts will be populated here -->
            </div>
        </div>
    </div>

    <!-- Demographics & ROI -->
    <div class="bottom-row">
        <div class="demo-card">
            <div class="card-header">
                <h3>Audience Demographics</h3>
            </div>
            <div class="gender-breakdown">
                <div class="gender-item">
                    <div class="gender-info">
                        <div class="gender-name">Male</div>
                        <div class="gender-percentage" id="malePercentage">0%</div>
                    </div>
                    <div class="gender-bar">
                        <div class="gender-fill male" id="maleBar"></div>
                    </div>
                </div>
                <div class="gender-item">
                    <div class="gender-info">
                        <div class="gender-name">Female</div>
                        <div class="gender-percentage" id="femalePercentage">0%</div>
                    </div>
                    <div class="gender-bar">
                        <div class="gender-fill female" id="femaleBar"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="roi-card">
            <div class="roi-header">
                <h3>Social Media ROI</h3>
                <div class="roi-value" id="socialConversions">0%</div>
            </div>
            <div class="roi-description">
                Social traffic conversion rate
            </div>
        </div>
    </div>
</div>

<style>
.analytics-social {
    padding: 2rem;
}

.social-overview {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.overview-card {
    background: var(--admin-surface);
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-lg);
    padding: 1.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    transition: all 0.2s ease;
}

.overview-card:hover {
    box-shadow: var(--admin-shadow-lg);
    transform: translateY(-2px);
}

.card-icon {
    width: 60px;
    height: 60px;
    border-radius: var(--admin-radius-lg);
    background: linear-gradient(135deg, var(--admin-primary), var(--admin-secondary));
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
}

.card-content {
    flex: 1;
}

.card-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--admin-text-primary);
    margin-bottom: 0.25rem;
}

.card-label {
    font-size: 0.875rem;
    color: var(--admin-text-secondary);
    margin-bottom: 0.5rem;
}

.card-trend {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.75rem;
    font-weight: 600;
}

.card-trend.positive {
    color: var(--admin-success);
}

.card-trend.negative {
    color: var(--admin-error);
}

/* Social Performance Section */
.social-performance-section {
    background: var(--admin-surface);
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-lg);
    overflow: hidden;
    margin-bottom: 2rem;
}

.section-header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--admin-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.section-header h2 {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--admin-text-primary);
    margin: 0;
}

.platform-filters {
    display: flex;
    gap: 0.5rem;
}

.platform-filter-btn {
    padding: 0.375rem 0.75rem;
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-md);
    background: var(--admin-surface);
    color: var(--admin-text-secondary);
    font-size: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.platform-filter-btn.active {
    background: var(--admin-primary);
    color: white;
    border-color: var(--admin-primary);
}

.chart-content {
    padding: 1.5rem;
    height: 300px;
}

/* Platform Breakdown */
.platform-breakdown {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.breakdown-card {
    background: var(--admin-surface);
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-lg);
    overflow: hidden;
}

.breakdown-card .card-header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--admin-border);
}

.breakdown-card .card-header h3 {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--admin-text-primary);
    margin: 0;
}

.breakdown-card .content {
    padding: 1.5rem;
}

/* Platforms Grid */
.platforms-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.platform-card {
    background: var(--admin-bg);
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-md);
    padding: 1rem;
    text-align: center;
    transition: all 0.2s ease;
}

.platform-card:hover {
    box-shadow: var(--admin-shadow-lg);
    transform: translateY(-2px);
}

.platform-icon {
    width: 50px;
    height: 50px;
    border-radius: var(--admin-radius-md);
    background: var(--admin-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
    margin: 0 auto 1rem;
}

.platform-name {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--admin-text-primary);
    margin-bottom: 1rem;
}

.platform-stats {
    display: flex;
    justify-content: space-around;
}

.platform-stat {
    text-align: center;
}

.platform-stat-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--admin-primary);
    display: block;
}

.platform-stat-label {
    font-size: 0.75rem;
    color: var(--admin-text-secondary);
}

/* Top Posts List */
.top-posts-list {
    max-height: 300px;
    overflow-y: auto;
}

.post-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem 0;
    border-bottom: 1px solid var(--admin-border);
}

.post-item:last-child {
    border-bottom: none;
}

.post-rank {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: var(--admin-primary);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: 600;
}

.post-content {
    flex: 1;
}

.post-text {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--admin-text-primary);
    margin-bottom: 0.25rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.post-metrics {
    font-size: 0.75rem;
    color: var(--admin-text-secondary);
}

/* Bottom Row */
.bottom-row {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 1.5rem;
}

.demo-card {
    background: var(--admin-surface);
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-lg);
    overflow: hidden;
}

.demo-card .card-header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--admin-border);
}

.demo-card .card-header h3 {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--admin-text-primary);
    margin: 0;
}

.demo-card .content {
    padding: 1.5rem;
}

/* Gender Breakdown */
.gender-breakdown {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.gender-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--admin-surface);
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-md);
}

.gender-info {
    flex: 1;
}

.gender-name {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--admin-text-primary);
    margin-bottom: 0.25rem;
}

.gender-percentage {
    font-size: 0.75rem;
    color: var(--admin-text-secondary);
}

.gender-bar {
    width: 100px;
    height: 8px;
    background: var(--admin-border);
    border-radius: 4px;
    overflow: hidden;
}

.gender-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.3s ease;
}

.gender-fill.male { background: var(--admin-primary); }
.gender-fill.female { background: var(--admin-secondary); }

/* ROI Card */
.roi-card {
    background: var(--admin-surface);
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-lg);
    overflow: hidden;
    text-align: center;
}

.roi-card .header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--admin-border);
}

.roi-card .header h3 {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--admin-text-primary);
    margin: 0 0 1rem 0;
}

.roi-card .content {
    padding: 1.5rem;
}

.roi-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--admin-primary);
    margin-bottom: 0.5rem;
}

.roi-description {
    font-size: 0.875rem;
    color: var(--admin-text-secondary);
}

/* Responsive Design */
@media (max-width: 1024px) {
    .platform-breakdown {
        grid-template-columns: 1fr;
    }
    
    .bottom-row {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .analytics-social {
        padding: 1rem;
    }

    .social-overview {
        grid-template-columns: 1fr;
    }

    .platforms-grid {
        grid-template-columns: 1fr;
    }

    .section-header {
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
    }

    .platform-filters {
        width: 100%;
        justify-content: center;
    }

    .overview-card {
        padding: 1rem;
    }

    .card-icon {
        width: 50px;
        height: 50px;
        font-size: 1.25rem;
    }

    .card-value {
        font-size: 1.5rem;
    }
}
</style>

<script>
// Social Media Analytics JavaScript
document.addEventListener('DOMContentLoaded', function() {
    initSocialAnalytics();
});

function initSocialAnalytics() {
    loadSocialData();
    initPlatformFilters();
}

function loadSocialData() {
    fetch('/api/analytics/social')
        .then(response => response.json())
        .then(data => {
            updateSocialOverview(data.overview);
            updateSocialChart(data.performance);
            updatePlatformBreakdown(data.platforms);
            updateTopPosts(data.topPosts);
            updateGenderDemographics(data.demographics);
            updateSocialROI(data.roi);
        })
        .catch(error => {
            console.error('Error loading social data:', error);
            showFallbackSocialData();
        });
}

function updateSocialOverview(overview) {
    document.getElementById('totalFollowers').textContent = overview.totalFollowers.toLocaleString();
    document.getElementById('totalEngagement').textContent = overview.totalEngagement.toLocaleString();
    document.getElementById('totalImpressions').textContent = overview.totalImpressions.toLocaleString();
    document.getElementById('totalShares').textContent = overview.totalShares.toLocaleString();

    updateTrend('followersTrend', overview.followersChange);
    updateTrend('engagementTrend', overview.engagementChange);
    updateTrend('impressionsTrend', overview.impressionsChange);
    updateTrend('sharesTrend', overview.sharesChange);
}

function updateTrend(elementId, change) {
    const element = document.getElementById(elementId);
    const span = element.querySelector('span');
    span.textContent = (change >= 0 ? '+' : '') + Math.abs(change).toFixed(1) + '%';
}

function updateSocialChart(performanceData) {
    const ctx = document.getElementById('socialPerformanceChart').getContext('2d');

    // Destroy existing chart if it exists
    if (window.socialChart) {
        window.socialChart.destroy();
    }

    window.socialChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: performanceData.labels,
            datasets: [{
                label: 'Followers',
                data: performanceData.followers,
                borderColor: 'var(--accent)',
                backgroundColor: 'rgba(124, 58, 237, 0.1)',
                tension: 0.4
            }, {
                label: 'Engagement',
                data: performanceData.engagement,
                borderColor: 'var(--secondary)',
                backgroundColor: 'rgba(236, 72, 153, 0.1)',
                tension: 0.4
            }, {
                label: 'Impressions',
                data: performanceData.impressions,
                borderColor: 'var(--success, #10b981)',
                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

function updatePlatformBreakdown(platforms) {
    const container = document.getElementById('platformsGrid');
    container.innerHTML = platforms.map(platform => `
        <div class="platform-card">
            <div class="platform-icon">
                <i class="ph-bold ${platform.icon}"></i>
            </div>
            <div class="platform-name">${platform.name}</div>
            <div class="platform-stats">
                <div class="platform-stat">
                    <span class="platform-stat-value">${platform.followers.toLocaleString()}</span>
                    <span class="platform-stat-label">Followers</span>
                </div>
                <div class="platform-stat">
                    <span class="platform-stat-value">${platform.engagement.toLocaleString()}</span>
                    <span class="platform-stat-label">Engagement</span>
                </div>
            </div>
        </div>
    `).join('');
}

function updateTopPosts(posts) {
    const container = document.getElementById('topPostsList');
    container.innerHTML = posts.map((post, index) => `
        <div class="post-item">
            <div class="post-rank">${index + 1}</div>
            <div class="post-content">
                <div class="post-text">${post.text}</div>
                <div class="post-metrics">${post.likes} likes • ${post.shares} shares • ${post.comments} comments</div>
            </div>
        </div>
    `).join('');
}

function updateGenderDemographics(demographics) {
    // Update gender breakdown only
    const totalGender = demographics.gender.male + demographics.gender.female + demographics.gender.other;
    updateGenderBar('male', demographics.gender.male, totalGender);
    updateGenderBar('female', demographics.gender.female, totalGender);
}

function updateGenderBar(gender, count, total) {
    const percentage = total > 0 ? (count / total * 100) : 0;
    document.getElementById(`${gender}Percentage`).textContent = Math.round(percentage) + '%';
    document.getElementById(`${gender}Bar`).style.width = percentage + '%';
}

// Removed unused functions: updateCountries, updateContentStrategy, updateTags
// These were part of sections that were simplified/removed from the layout

function updateSocialROI(roi) {
    document.getElementById('socialConversions').textContent = roi.conversions + '%';
    document.getElementById('costPerAcquisition').textContent = '$' + roi.cpa.toFixed(2);
    document.getElementById('socialValue').textContent = '$' + roi.value.toLocaleString();
}

function initPlatformFilters() {
    document.querySelectorAll('.platform-filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.platform-filter-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            loadPlatformData(this.dataset.platform);
        });
    });
}

function loadPlatformData(platform) {
    fetch(`/api/analytics/social/platform?platform=${platform}`)
        .then(response => response.json())
        .then(data => {
            updateSocialChart(data.performance);
            updatePlatformBreakdown(data.platforms);
        })
        .catch(error => console.error('Error loading platform data:', error));
}

function showFallbackSocialData() {
    // Show sample data when API is not available
    updateSocialOverview({
        totalFollowers: 45231,
        totalEngagement: 8921,
        totalImpressions: 156432,
        totalShares: 2341,
        followersChange: 15.2,
        engagementChange: 22.4,
        impressionsChange: 18.7,
        sharesChange: 12.1
    });
}
</script>